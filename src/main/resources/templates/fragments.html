<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<!-------------------------- fragments ---------------------------------------------------->
<head th:fragment="head">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9, minimum-scale=0.9, shrink-to-fit=no, user-scalable=no">

  <meta property="og:type" content="website" />
  <meta property="og:title" content="S W E E T M E M E" />

  <title>Sweet Meme</title>

  <link href="https://fonts.googleapis.com/css?family=Noto+Sans+KR:300,400,500&display=swap" rel="stylesheet">
  <link rel="stylesheet" th:href="@{/node_modules/bootstrap/dist/css/bootstrap.css}" />
  <link rel="stylesheet" th:href="@{/node_modules/@yaireo/tagify/dist/tagify.css}" />
  <link id="contextPathHolder" th:data-contextPath="${#httpServletRequest.getContextPath()}"/>
  <link rel="stylesheet" th:href="@{/node_modules/font-awesome/css/font-awesome.css}" />

  <style id="commonStyle">
    .commentVoteBtn {
      padding: 0px;
      margin: 0px;
      width: 40px;
      height: 20px;
    }

    body::-webkit-scrollbar-track
    {
      -webkit-box-shadow: inset 0 0 3px rgba(255, 255, 255, 0);

    }

    body::-webkit-scrollbar
    {
      background-color: rgb(33, 37, 41);
      width: 3px;
    }

    body::-webkit-scrollbar-thumb
    {
      border-radius: 3px;
      background-color: rgb(248, 249, 250);
    }
    body,
    input,
    button,
    select,
    optgroup,
    textarea,
    .tooltip,
    .popover {
      font-family: -apple-system, BlinkMacSystemFont, "Noto Sans KR", "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
    }
    .commentHover :hover {
      background-color: #eeeeee;
      mix-blend-mode: normal;
    }
  </style>
  <style id="forMobilePage">
    .container {
      max-width: 1024px;
      width: 85%;
    }
    @media (max-width: 765px) {
      .container {
        width: 90%;
      }
    }
    @media (max-width: 572px) {
      .container {
        width: 100%;
      }
    }
  </style>
  <style id="forOffCanvasAndSideBar">
    #offcanvas {
      transition: all 0.2s ease;
    }
    #offcanvas {
      transition: all 0.2s ease;
    }

    .nav > .nav-item :hover{
      background-color: #11111110;
      background-blend-mode: normal;

    }
    .nav > .nav-item > .nav-link{
      color: black;
    }
    #side-bar {
      top: 80px;
      position: sticky;
      overflow: auto;
      /*height: 500px;*/
      max-width: 200px;
      min-width: 178px;
      -webkit-overflow-scrolling: touch;
    }
    #side-bar::-webkit-scrollbar-track
    {
      -webkit-box-shadow: inset 0 0 2px rgba(0, 0, 0, 0.22);

    }

    #side-bar::-webkit-scrollbar
    {
      width: 2px;
    }

    #side-bar::-webkit-scrollbar-thumb
    {
      border-radius: 2px;
      background-color: rgba(33, 37, 41, 0.82);
    }
  </style>
  <style id="forNaviBar">
    #nav-bar {
      transition: top 0.3s;
    }
    #navbar {
      transition: height 0.3s ease;
    }

  </style>
  <style id="tagifyStyle">

    .tagify__dropdown.extra-properties .tagify__dropdown__item > img{
      display: inline-block;
      vertical-align: middle;
      height: 20px;
      transform: scale(.75);
      margin-right: 5px;
      border-radius: 2px;
      transition: .12s ease-out;
    }

    .tagify__dropdown.extra-properties .tagify__dropdown__item--active > img,
    .tagify__dropdown.extra-properties .tagify__dropdown__item:hover > img{
      transform: none;
      margin-right: 12px;
    }

    .tagify.countries .tagify__input{ min-width:175px; }

    .tagify.countries tag{ white-space:nowrap; }
    .tagify.countries tag img{
      display: inline-block;
      height: 16px;
      margin-right: 3px;
      border-radius: 2px;
    }

    .tags-look .tagify__dropdown__item {
      display: inline-block;
      border-radius: 3px;
      padding: .3em .5em;
      border: 1px solid #CCC;
      background: #F3F3F3;
      margin: .2em;
      font-size: .85em;
      color: black;
      transition: 0s;
  }

  .tags-look .tagify__dropdown__item--active{
    color: black;
  }

  .tags-look .tagify__dropdown__item:hover{
    background: #D3E2E2;
    border-color: #D3E2E2;
  }
  </style>
  <style id="bs5CustomStyle">

    .btn-group-xs > .btn, .btn-xs {
      padding: 1px 5px;
      font-size: 12px;
      line-height: 1.5;
      border-radius: 3px;
    }

    .btn:focus, .form-check-input:focus,  .navbar-toggler:focus {
      outline: none;
      box-shadow: none;
    }

  </style>

  <script th:src="@{/node_modules/jquery/dist/jquery.min.js}"></script>
  <script th:src="@{/node_modules/bootstrap/dist/js/bootstrap.bundle.js}"></script>
  <script title="grid Lazy Load">
    $(document).ready(function () {
      if(document.getElementById("side-bar-col") == null) return;

      if(window.innerWidth > 572) {
        window.removeEventListener("touchstart", startTouch,{ passive: false });
        window.removeEventListener("touchmove", moveTouch,{ passive: false });
        document.getElementById('side-bar-col').classList.remove('d-none');
      }
      else {
        window.addEventListener("touchstart", startTouch,{ passive: false });
        window.addEventListener("touchmove", moveTouch,{ passive: false });
      }
      document.getElementById('gridContent').classList.remove('d-none');

      resizer();

      checkScroll();
    });
  </script>
  <script title="context path variable">
    let contextPath = $('#contextPathHolder').attr('data-contextPath') ? $('#contextPathHolder').attr('data-contextPath') : '';
  </script>
  <script th:src="@{/node_modules/jdenticon/dist/jdenticon.min.js}"></script>
</head>
<nav th:fragment="nav-bar" id="nav-bar" class="navbar fixed-top navbar-expand-sm navbar-dark bg-dark">
  <div class="container">
    <!-- logo -->
    <a class="navbar-brand" href="#" th:href="@{/}">SweetMeme</a>

    <!-- mobile section choose btn-->
    <a id="offCanvasToggle" class="navbar-toggler btn me-auto d-none" data-bs-toggle="offcanvas"
       href="#offcanvas" role="button" aria-controls="offcanvas">
      Section
    </a>

    <!-- 작은화면 메뉴 -->
    <button class="navbar-toggler" id="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar"
            aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <i class="fa fa-bars" aria-hidden="true"></i>
    </button>
    <div class="collapse navbar-collapse" id="navbar">
      <!-- 좌측 컨텐츠 -->
      <ul id="nav-left-content" class="navbar-nav me-auto mb-2 mb-lg-0">
      </ul>

      <!-- 우측 컨텐츠 -->
      <ul class="navbar-nav .justify-content-end">

        <!-- 게스트 -->
        <li class="nav-item" sec:authorize="!isAuthenticated()">
          <a class="nav-link" href="#" th:href="@{/login}">Log in</a>
        </li>

        <li class="nav-item" sec:authorize="!isAuthenticated()">
          <a class="nav-link" href="#" th:href="@{/sign-up}">Sign up</a>
        </li>

        <!-- 알림 -->
        <li class="nav-item dropdown mt-1" sec:authorize="isAuthenticated()">
          <a th:if="${hasNotification > 0}" class="nav-link" href="#" th:onclick="|notificationPeek()|" id="NotiDropdown" role="button"
             data-bs-toggle="dropdown" aria-expanded="false" style="padding: 0px; margin: 0px">
            <i class="fa fa-bell-o" aria-hidden="true"></i> notification
            <span th:text="${hasNotification}" class="badge rounded-pill bg-danger">Danger</span>
            &nbsp;
          </a>
          <a th:if="${hasNotification <= 0}" class="nav-link" href="#" th:onclick="|notificationPeek()|" id="NotiDropdown" role="button"
             data-bs-toggle="dropdown" aria-expanded="false" style="padding: 0px; margin: 0px">
            <i class="fa fa-bell-o" aria-hidden="true"></i> notification&nbsp;
          </a>
          <ul th:replace="fragments.html :: notifications"></ul>
        </li>

        <script title="notification Peek ajax">
          var notificationPeek = function () {
            $.ajax({
              method: "GET",
              url: contextPath + "/notifications/peek",
              processData: false,
            }).done(function(div) {
              $('#notificationPeek').replaceWith(div);
            })
          }
        </script>
        &nbsp;&nbsp;&nbsp;
        <!-- 업로드 -->
        <li class="nav-item mt-1" sec:authorize="isAuthenticated()">
          <a th:if="${member.emailVerified}" class="nav-link" href="#" th:href="@{/upload/post}" style="margin: 0px; padding: 0px">
            <i class="fa fa-plus fa-lg" aria-hidden="true"></i>
            upload
          </a>
          <a th:if="${!member.emailVerified}" class="nav-link" href="#" th:href="@{/email/verify}" style="margin: 0px; padding: 0px">
            <i class="fa fa-plus fa-lg" aria-hidden="true"></i>
            upload
          </a>

        </li>
        &nbsp;&nbsp;&nbsp;&nbsp;
        <!-- 유저 아바타 드롭다운-->
        <li class="nav-item dropdown" sec:authorize="isAuthenticated()">
          <a class="nav-link dropdown-toggle" href="#" id="dropdown07" role="button" data-bs-toggle="dropdown" aria-expanded="false" style="padding: 0px; margin-top: 0px">
            <svg th:if="${member.memberInfo.picImage} == null" th:data-jdenticon-value="${#authentication.name}"
                 width="30px" height="30px" class="rounded border bg-light"></svg>
            <img th:if="${member.memberInfo.picImage} != null" th:src="@{'/avatar/' + ${member.memberInfo.picImage}}"
                           width="30px" height="30px" style="padding: 0px; margin: 5px" class="rounded border"/>
          </a>

          <!-- 유저 드롭다운 메뉴 -->
          <ul class="dropdown-menu dropdown-menu-light text-small shadow mt-2" aria-labelledby="dropdown07">
            <li><a class="dropdown-item my-2" th:href="@{'/user/' + ${#authentication.name} + '/home'}" th:text="#{myProfile}">내 프로필</a></li>
            <li><a class="dropdown-item my-2" th:href="@{'/settings/account'}" href="#" th:text="#{settings}">설정</a></li>
            <li>
              <form class="form-inline my-2" action="#" th:action="@{/member/logout}" method="post">
                <button class="dropdown-item" th:text="#{logout}" type="submit">
                  logout
                </button>
              </form>
            </li>
            <li><span class="my-2" style="font-size: 12px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SWEETMEME © 2021</span></li>
          </ul>
        </li>
      </ul>
    </div>
  </div>
</nav>
<ul th:fragment="notifications" class="dropdown-menu dropdown-menu-light text-small shadow dropdown-menu-lg-start" aria-labelledby="NotiDropdown">
  <div id="notificationPeek">
    <li th:each="notification : ${notifications}">
      <a class="dropdown-item" th:style="${!notification.hasRead} ? 'background-color: #11111110;'"
         th:href="@{'/notification/post/' + ${notification.notificationType} + '/' + ${notification.originalPostId}}" th:target="_blank">
        <span th:text="${notification.lastVoteOrCommenter.head}" class="fw-bold">USER NAME</span>
        <span th:if="${notification.notificationType.name()} == 'UPVOTE_POST'">
          <span th:if="${notification.voteOrCommentCounter} > 1">
            <span th:text="#{notification.common.many1}">님 외</span>
            <span th:text="${notification.voteOrCommentCounter}">#</span>
            <span th:text="#{notification.upvote.post.many2}">명이 포스트를 업보트했습니다.</span>
          </span>
          <span th:if="${notification.voteOrCommentCounter} <= 1" th:text="#{notification.upvote.post.one}">
            님이 포스트를 업보트했습니다.
          </span>
        </span>
        <span th:if="${notification.notificationType.name()} == 'UPVOTE_COMMENT'">
          <span th:if="${notification.voteOrCommentCounter} > 1">
            <span th:text="#{notification.common.many1}">님 외</span>
            <span th:text="${notification.voteOrCommentCounter}">#</span>
            <span th:text="#{notification.upvote.comment.many2}">명이 코멘트를 업보트했습니다.</span>
          </span>
          <span th:if="${notification.voteOrCommentCounter} <= 1" th:text="#{notification.upvote.comment.one}">
            님이 코멘트를 업보트했습니다.
          </span>
        </span>
        <span th:if="${notification.notificationType.name()} == 'COMMENT'">
          <span th:if="${notification.voteOrCommentCounter} > 1">
            <span th:text="#{notification.common.many1}">님 외</span>
            <span th:text="${notification.voteOrCommentCounter}">#</span>
            <span th:text="#{notification.comment.many2}">명이 코멘트 했습니다.</span>
          </span>
          <span th:if="${notification.voteOrCommentCounter} <= 1" th:text="#{notification.comment.one}">
            님이 코멘트했습니다.
          </span>
        </span>
           - <span class="date" th:text="${#temporals.format(notification.lastVoteOrCommentDate, 'MM/dd HH:mm')}"></span>
      </a>
    </li>
  </div>
  <li><hr class="dropdown-divider"></li>
  <li>
    <a class="dropdown-item" th:text="#{notification.view-all}" style="text-align: center" th:href="@{'/notifications/all'}">
      모든 알림 보기
    </a>
  </li>
</ul>
<div th:fragment="side-bar(currentMenu)" id="side-bar" class="nav d-flex sticky-top flex-column flex-shrink-0 p-3 bg-light">
  <div class="navbar-expand-lg navbar-light">
    <ul th:replace="fragments.html :: content(${currentMenu})"></ul>
  </div>

  <script id="gridForMobile" type="application/javascript" th:inline="javascript">
    var resizer = function () {
      if(window.innerWidth <= 572) {
        if(!document.getElementById('side-bar-col').classList.contains('d-none')) {
          document.getElementById('side-bar-col').classList.add('d-none');

          window.addEventListener("touchstart", startTouch,{ passive: false });
          window.addEventListener("touchmove", moveTouch,{ passive: false });
        }
      }
      else {
        if(document.getElementById('side-bar-col').classList.contains('d-none')) {
          document.getElementById('side-bar-col').classList.remove('d-none');

          window.removeEventListener("touchstart", startTouch,{ passive: false });
          window.removeEventListener("touchmove", moveTouch,{ passive: false });
        }
      }
      if(window.innerWidth <= 765) {
        if(document.getElementById('side-bar-col').classList.contains('col-3')) {
          document.getElementById('side-bar-col').classList.remove('col-3');
          document.getElementById('side-bar-col').classList.add('col-4');
        }
      }
      else {
        if(document.getElementById('side-bar-col').classList.contains('col-4')) {
          document.getElementById('side-bar-col').classList.remove('col-4');
          document.getElementById('side-bar-col').classList.add('col-3');
        }
      }
    }
    window.onresize = resizer;
  </script>
</div>
<div th:fragment="off-canvas(currentMenu)" id="off-canvas">
  <div class="offcanvas offcanvas-start" tabindex="-1" id="offcanvas" style="width: 250px;" aria-labelledby="offcanvasLabel">

    <div class="offcanvas-header bg-dark">
      <h5 class="offcanvas-title text-light" style="height: 24px;">SweetMeme</h5>
      <button type="button" class="btn-close btn-close-white text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
    </div>

    <div class="offcanvas-body bg-light text-white">
        <ul th:replace="fragments.html :: content(${currentMenu})"></ul>
    </div>

    <script title="swipe Event">
      var swipeEventInit = function () {
        if(window.innerWidth <= 572) {
          window.addEventListener("touchstart", startTouch,{ passive: false });
          window.addEventListener("touchmove", moveTouch,{ passive: false });
        }
        else {
          window.removeEventListener("touchstart", startTouch,{ passive: false });
          window.removeEventListener("touchmove", moveTouch,{ passive: false });
        }
      }

      // Swipe Up / Down / Left / Right
      var initialX = null;
      var initialY = null;

      function startTouch(e) {
        initialX = e.touches[0].clientX;
        initialY = e.touches[0].clientY;
      }

      function moveTouch(e) {
        if (initialX === null) {
          return;
        }

        if (initialY === null) {
          return;
        }

        var currentX = e.touches[0].clientX;
        var currentY = e.touches[0].clientY;

        var diffX = initialX - currentX;
        var diffY = initialY - currentY;


        if (Math.abs(diffX) < Math.abs(diffY)) {
          if(window.innerWidth <= 572) {
            var currentScrollPos = window.pageYOffset;
            var navbar = document.getElementById("nav-bar");
            var innerNavbar = document.getElementById("navbar");

            if (diffY < -2) {
              navbar.style.top = "0px";
            }
            else {
              navbar.style.top = "-60px";
              innerNavbar.classList.remove("show");
            }
          }
        }
        if (Math.abs(diffX) > Math.abs(diffY)) {
          if (diffX < 10) {
            document.getElementById('offCanvasToggle').click();
          }
        }

        initialX = null;
        initialY = null;

      }
    </script>
  </div>
</div>
  <ul th:fragment="content(currentMenu)" class="nav nav-pills flex-column mb-auto">
  <!-- for navigation bar and off-canvas content-->
  <div class="d-flex align-items-centertext-decoration-none">
    <svg width="15" height="32"></svg>
    <span class="fs-4" style="color: black">Home</span>
  </div>

  <hr style="color: black"/>

  <li class="nav-item">
    <a class="nav-link" th:style="${currentMenu == 'fresh'}? 'background-color: #11111110;'" th:href="@{/}">
      <i class="fa fa-clock-o" aria-hidden="true"></i>
      &nbsp; Fresh
    </a>
  </li>

  <li class="nav-item">
    <a class="nav-link" th:style="${currentMenu == 'hot'}? 'background-color: #11111110;'" th:href="@{/hot}">
      <i class="fa fa-line-chart" aria-hidden="true"></i>
      &nbsp;Hot
    </a>
  </li>

  <li class="nav-item">
    <a class="nav-link" th:style="${currentMenu == 'top'}? 'background-color: #11111110;'" th:href="@{/top}">
      <i class="fa fa-align-left" aria-hidden="true"></i>
      &nbsp;Top
    </a>
  </li>

  <div class="mb-3"></div>

  <div class="d-flex align-items-centertext-decoration-none">
    <svg width="15" height="32"></svg>
    <span class="fs-4" style="color: black">Section</span>
  </div>

  <hr style="color: black"/>

  <li class="nav-item" th:each="sectionType : ${sidebarSectionTypes}">
    <a th:href="@{'/'+${sectionType}}" class="nav-link" th:style="(${sectionType} == ${currentMenu}) ? 'background-color: #11111110;': ''">
      <img th:src="@{'/sections/' + ${sectionType}}" width="20px;" height="20px;" class="rounded"/>&nbsp;
      <span th:text="${sectionType}" th:remove="tag"></span>
    </a>
  </li>
</ul>

<div th:fragment="profileInfo">
  <div class="row">
    <div class="col-2">
      <a th:href="@{/}" style="padding: 0px; margin: 0px">
      <svg th:if="${info.picImage} == null" th:data-jdenticon-value="${info.head}"
           width="60px" height="60px" style="background-size: cover;" class="rounded border bg-light">
      </svg>
      <img th:if="${info.picImage} != null" th:src="@{'/avatar/' + ${info.picImage}}"
           width="60px" height="60px" style=" object-fit: cover;margin: 5px" class="rounded border"/>
      </a>
    </div>
    <div class="col-10">
      <h2 th:text="${info.head}" style="display: inline" class="fw-bold "></h2>&nbsp;
      <img th:if="${info.stateCode} != null" th:src="'https://lipis.github.io/flag-icon-css/flags/4x3/' + ${info.stateCode} + '.svg'" style="width: 2rem; height: 1.5rem; vertical-align: text-bottom" class="rounded border">
      <br/>
      <small class="text-muted">s p e n d · </small><small class="text-muted" th:text="${spendDate} + ' days'"></small>
    </div>
  </div>
  <p class="my-3" th:text="${info.description}"></p>
</div>
<div th:fragment="profileTab(profileMenu)">
  <ul class="nav nav-tabs">
    <li class="nav-item">
      <a class="nav-link" th:classappend="${profileMenu == 'home'}? active" aria-current="page" href="#"
         th:href="@{'/user/' + ${info.head} + '/home'}">Home</a>
    </li>
    <li class="nav-item">
      <a class="nav-link" th:classappend="${profileMenu == 'posts'}? active" aria-current="page" href="#"
         th:href="@{'/user/' + ${info.head} + '/posts'}">Posts</a>
    </li>
    <li class="nav-item">
      <a class="nav-link" th:classappend="${profileMenu == 'comments'}? active" href="#"
         th:href="@{'/user/' + ${info.head} + '/comments'}">Comments</a>
    </li>
    <li class="nav-item">
      <a class="nav-link" th:classappend="${profileMenu == 'upvotes'}? active" href="#"
         th:href="@{'/user/' + ${info.head} + '/upvotes'}">Upvotes</a>
    </li>
  </ul>
</div>
<div th:fragment="settingsTab(settingsMenu)">
  <ul class="nav nav-tabs">
    <li class="nav-item">
      <a class="nav-link"
         th:classappend="${settingsMenu == 'account'}? active" aria-current="page" href="#"
         th:href="@{'/settings/account'}">account</a>
    </li>
    <li class="nav-item">
      <a class="nav-link" th:classappend="${settingsMenu == 'profile'}? active" aria-current="page" href="#"
         th:href="@{'/settings/profile'}">profile</a>
    </li>
    <li class="nav-item">
      <a class="nav-link" th:classappend="${settingsMenu == 'password'}? active" aria-current="page" href="#"
         th:href="@{'/settings/password'}">password</a>
    </li>
  </ul>
</div>

<script th:fragment="form-validation" type="application/javascript">
  (function () {
    'use strict';

    window.addEventListener('load', function () {
      var forms = document.getElementsByClassName('needs-validation');

      Array.prototype.filter.call(forms, function (form) {
        form.addEventListener('submit', function (event) {
          if (form.checkValidity() === false) {
            event.preventDefault();
            event.stopPropagation();
          }

          form.classList.add('was-validated')
        }, false)
      })
    }, false)
  }())
</script>
<script th:fragment="ajax-csrf-header" sec:authorize="isAuthenticated()" type="application/javascript" th:inline="javascript" >
  $(function() {

    var csrfToken = /*[[${_csrf.token}]]*/ null;
    var csrfHeader = /*[[${_csrf.headerName}]]*/ null;

    $(document).ajaxSend(function (e, xhr, options) {
      xhr.setRequestHeader(csrfHeader, csrfToken);
    });
  });
</script>

<!-- .postSection is used by paging -->
<section class="postSection" th:fragment="postSection">
  <article th:each="post : ${posts}" class="mx-1">
    <header>
      <div class="row">
        <div class="col-10 mt-2">
          <img th:src="@{'/sections/' + ${post.belongedSectionType}}" class="rounded" width="20px" height="20px" />
          <small th:text="${post.belongedSectionType}"></small><small> · </small>
          <small th:text="${#temporals.format(post.createdDate, 'yyyy-MM-dd HH:mm')}"></small>
        </div>
        <div class="col-2 text-end">
          <div class="dropdown mt-2">
            <button type="button" class="btn btn-light btn-sm" id="postDropdownMenuBtn" data-bs-toggle="dropdown" aria-expanded="false">
              <i class="fa fa-ellipsis-h" aria-hidden="true"></i>
            </button>
            <ul class="dropdown-menu dropdown-menu-light text-small shadow" aria-labelledby="postDropdownMenuBtn">
              <li><a class="dropdown-item" th:href="@{${DOWNLOAD_URL} + ${post.postImageUrl}}">download</a></li>
              <li sec:authorize="isAuthenticated()" th:if="${profileMenu != null}"><a class="dropdown-item" th:href="@{'/post/delete/'+${post.id}}">delete</a></li>
              <li sec:authorize="isAuthenticated()" th:if="${currentMenu != null}"><a href="#" class="dropdown-item">report</a></li>
            </ul>
          </div>
        </div>
      </div>

      <div class="row">
        <a th:onclick="|window.open(@{/} + 'post/' + ${post.id}, '_blank').focus()|" style="cursor: pointer;">
          <span class="col fw-bold fs-3 m-1" style="word-wrap: break-word;" th:text="${post.title}"></span>
        </a>
        </div>
    </header>
    <picture class="row justify-content-center rounded m-1" style="background-color: #11111110;">
      <video preload="metadata" muted autoplay loop th:if="${post.getContentType()} == 'mp4'" th:src="@{${FILE_URL} + ${post.postImageUrl}}"
             style="width: 100%; max-width: 600px; height: auto; max-height: 700px; cursor: pointer;" onclick="toggleMute(this)"></video>
      <img th:if="${post.getContentType()} != 'mp4'" th:src="@{${FILE_URL} + ${post.postImageUrl}}"
           style="width: 100%; max-width: 600px; height: auto;" alt="post.webp" />
    </picture>
    <div th:replace="fragments.html :: voteAndShareRow"></div>
    <hr/>
  </article>
  <div th:if="${#lists.isEmpty(posts)}" style="text-align: center">
    <div class="mt-4"></div>
    <i class="fa fa-times-circle fa-5x" aria-hidden="true" style="display: block"></i>
    <div class="mt-2"></div>
    <span class="p-3">There Is No Post!</span>
  </div>
</section>
  <script th:fragment="videoAutoPlay">
    var videos = document.getElementsByTagName("video");
    var browserClickInit = false;
    var videoPlayScrollFlag = false;

    function checkScroll() {
      if(videoPlayScrollFlag == true) return;
      videoPlayScrollFlag = true;

      var fraction = 0.60;

      for(var i = 0; i < videos.length; i++) {
        var video = videos[i];

        var x = video.offsetLeft, y = video.offsetTop, w = video.offsetWidth, h = video.offsetHeight, r = x + w, //right
                b = y + h, //bottom
                visibleX, visibleY, visible;

        visibleX = Math.max(0, Math.min(w, window.pageXOffset + window.innerWidth - x, r - window.pageXOffset));
        visibleY = Math.max(0, Math.min(h, window.pageYOffset + window.innerHeight - y, b - window.pageYOffset));

        visible = visibleX * visibleY / (w * h);

        if (visible > fraction) {
          try {
            videos[i-1].pause();
            videos[i+1].pause();
          } catch (e) {
            // console.log(e);
          }

          video.play()

          if(browserClickInit === true) {
            if(video.getAttribute('userMuted') != null) video.muted = true;
            else video.muted = false;
          }
        }
        else {
          video.pause();
        }
      }
      window.setTimeout(() => videoPlayScrollFlag = false, 100)
    }

    window.onblur = function() {
      for(var i = 0; i < videos.length; i++) {
        var video = videos[i];

        video.pause();
      }
    };
    var toggleMute = function (e) {
      browserClickInit = true;

      if(e.muted == "") {
        e.muted = true;
        e.setAttribute('userMuted', '')
      }
      else {
        e.muted = false;
        e.removeAttribute('userMuted', '')
        if(e.isPaused) e.play();
      }
    }

    window.addEventListener('scroll', checkScroll, false);
    window.addEventListener('resize', checkScroll, false);
  </script>
  <script th:fragment="voteAjax">
    var vote = function (type, id, vote) {
      let btnClass=  "btn-outline-primary";
      let clicked = "btn-primary";

      var upVoteBtn = $('#vote'+id).children().eq(1).get(0);
      var downVoteBtn = $('#vote'+id).children().eq(2).get(0);
      var upVote = upVoteBtn.classList.contains(clicked);
      var downVote = downVoteBtn.classList.contains(clicked);
      var upVoteCount = upVoteBtn.value.split(' ')[1];
      var downVoteCount = downVoteBtn.value.split(' ')[1];

      if(!upVote && !downVote) {
        if(vote) {
          upVoteBtn.classList.remove(btnClass);
          upVoteBtn.classList.add(clicked);

          var t = Number(upVoteCount) + 1;
          upVoteBtn.value = '▲ ' + t;
        }
        else {
          downVoteBtn.classList.remove(btnClass);
          downVoteBtn.classList.add(clicked);

          var t = Number(downVoteCount) + 1;
          downVoteBtn.value = '▼ ' + t;
        }
      }
      if(downVote && !upVote) {
        var t = Number(downVoteCount) - 1;
        downVoteBtn.value = '▼ ' + t;

        downVoteBtn.classList.remove(clicked);
        downVoteBtn.classList.add(btnClass);

        if(vote) {
          upVoteBtn.classList.remove(btnClass);
          upVoteBtn.classList.add(clicked);

          var t = Number(upVoteCount) + 1;
          upVoteBtn.value = '▲ ' + t;
        }
      }
      if(!downVote && upVote) {
        var t = Number(upVoteCount) - 1;
        upVoteBtn.value = '▲ ' + t;

        upVoteBtn.classList.remove(clicked);
        upVoteBtn.classList.add(btnClass);

        if(!vote) {
          upVoteBtn.classList.remove(clicked);
          upVoteBtn.classList.add(btnClass);
          downVoteBtn.classList.remove(btnClass);
          downVoteBtn.classList.add(clicked);

          var t = Number(downVoteCount) + 1;
          downVoteBtn.value = '▼ ' + t;
        }
      }

      $.ajax({
        dataType: "json",
        autocomplete: {
          enabled: true,
          rightKey: true,
        },
        contentType: "application/json; charset=utf-8",
        method: "POST",
        url: contextPath + "/" + type +"/" + id + "/vote",
        data: JSON.stringify({id: id, vote: vote})
      })
    };
  </script>

<div th:fragment="commentForm">
  <form class="needs-validation col-sm-6" action="#" th:object="${commentForm}" style="width: 100%"
        th:action="@{'/post/comment/' + ${post.id}}" method="post" enctype="multipart/form-data" novalidate>

    <!-- 코멘트-->
    <div class="input-group">
      <span class="input-group-text" th:text="#{comment}">코멘트</span>
      <textarea id="content" name="content" th:field="*{content}" style="height: 90px;" class="form-control" aria-label="With textarea" max="100"></textarea>
      <small class="form-text text-danger" th:if="${#fields.hasErrors('content')}" th:errors="*{content}">
        콘텐트 에러
      </small>
    </div>

    <div id="ACCEPTABLE_COMMENT_TYPES" th:text="*{ACCEPTABLE_COMMENT_TYPES}" hidden></div>
    <div class="row justify-content-between">
      <div class="col-9">
        <!-- TODO 파일 선택 후 프리뷰 append -->
        <div class="form-group">
          <label class="btn btn-default p-0 mt-1">
            <input type="file" class="form-control" name="file" id="file" th:accept="*{ACCEPTABLE_COMMENT_TYPES}"
                   aria-describedby="fileHelp" th:field="*{file}" oninput="fileValidation()" />
          </label>
        </div>

      </div>
      <div class="col-3 mt-2 text-end">
        <div class="form-group">
          <button class="btn btn-primary btn-sm" type="submit" th:text="#{upload}">업로드</button>
        </div>
      </div>
    </div>
  </form>
</div>
<div th:fragment="comments" class="replyPageOffset">
  <div class="my-4 commentHover round" th:each="comment : ${comments}">
    <div class="row">
      <!-- 아바타 -->
      <div class="col-1">
        <a class="round" th:href="@{'/user/'+${comment.commenterInfo.head}+'/home'}" href="#" role="button">
          <svg th:if="${comment.commenterInfo.getPicImage()} == null" th:data-jdenticon-value="${comment.commenterInfo.head}"
               width="30px" height="30px" class="rounded border bg-light"></svg>
          <img th:href="@{'user/' + ${comment.commenterInfo.head} + '/home'}" th:if="${comment.commenterInfo.getPicImage()} != null" th:src="@{'/avatar/' + ${comment.commenterInfo.getPicImage()}}"
               width="30px" height="30px" class="rounded border"/>
        </a>
      </div>
      <!-- 코멘트 -->
      <div class="col ms-1 mb-2">
        <span class="fw-bold" th:text="${comment.commenterInfo.head}"></span>
        <img th:if="${comment.commenterInfo.stateCode} != null" th:src="'https://lipis.github.io/flag-icon-css/flags/4x3/' + ${comment.commenterInfo.stateCode} + '.svg'"
             style="width: 25px; height: 18px; vertical-align: text-bottom" class="rounded border">
        <div style="white-space: pre-line;" class="mt-2" th:text="${comment.content}"></div>
        <div th:if="${comment.descriptionImg} != null">
          <img th:src="@{'/comment/' + ${comment.descriptionImg}}" width="70%" class="rounded border"/>
        </div>
      </div>
      <div class="col-1" sec:authorize="isAuthenticated()">
        <div th:if="${member.commentedIds.contains(comment.id)}">
          <a type="button" data-bs-toggle="modal" th:data-bs-target="'#' + commentDeleteModal + ${comment.id}">
            <i class="fa fa-times" aria-hidden="true"></i>
          </a>

          <!-- Modal -->
          <div class="modal fade" th:id="commentDeleteModal + ${comment.id}" tabindex="-1" aria-labelledby="commentDeleteModalLabel" aria-hidden="true">
            <div class="modal-dialog">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title" id="commentDeleteModalLabel" th:text="#{comment.delete}">코멘트 삭제</h5>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                  <p th:text="#{comment.context}">코멘트를 삭제하시겠습니까?</p>
                </div>
                <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" th:text="#{cancel}">취소</button>
                  <form th:action="@{'/comment/' + ${comment.id} + '/' + ${postId} + '/delete'}" th:method="post">
                    <button type="submit" class="btn btn-danger" th:text="#{delete}"></button>
                  </form>
                </div>
              </div>
            </div>
          </div>
        </div>

      </div>
      <!-- reply, upvote, downvote btn -->
      <div>
        <div sec:authorize="isAuthenticated()" th:id="${'vote'+comment.id}" style="display: inline">
          <a th:if="${itIsReply == null} && ${member.emailVerified}" class="mt-1" style="text-decoration: none; cursor: pointer" type="button" th:onclick="|reply(${comment.id})|">
            reply
          </a>
          <a th:if="${itIsReply == null} && ${!member.emailVerified}" class="mt-1" style="text-decoration: none; cursor: pointer" type="button" th:href="@{/email/verify}">
            reply
          </a>

          <input type="button"  class="btn btn-sm ms-1" th:classappend="${member.upVoteCommentIds.contains(comment.id)} ? 'btn-primary' : 'btn-outline-primary'"
                 th:onclick="|vote('comment', ${comment.id}, true)|" th:value="'▲ ' + ${comment.getVote().upVote}" style="padding: 0px; margin: 0px; width: 40px; height: 20px;"/>
          <input type="button" class="btn btn-sm ms-1" th:classappend="${member.downVoteCommentIds.contains(comment.id)} ? 'btn-primary' : 'btn-outline-primary'"
                 th:onclick="|vote('comment', ${comment.id}, false)|" th:value="'▼ ' + ${comment.getVote().downVote}" style="padding: 0px; margin: 0px; width: 40px; height: 20px;"/>
        </div>
        <div sec:authorize="!isAuthenticated()" th:id="${'vote'+comment.id}" style="display: inline">
          <a th:if="${itIsReply == null}" class="mt-1" style="text-decoration: none; cursor: pointer" type="button" th:onclick="|window.location.href = @{/} + 'login'|">
            reply
          </a>

          <input type="button" class="btn btn-outline-primary btn-sm ms-1" style="padding: 0px; margin: 0px; width: 40px; height: 20px;"
                 th:onclick="|window.location.href = @{/} + 'login'|" th:value="'▲ ' + ${comment.getVote().upVote}" />
          <input type="button" class="btn btn-outline-primary btn-sm ms-1" style="padding: 0px; margin: 0px; width: 40px; height: 20px;"
                 th:onclick="|window.location.href = @{/} + 'login'|" th:value="'▼ ' + ${comment.getVote().downVote}" />
        </div>
      </div>

      <!-- view # reply -->
      <a class="ms-4 mt-2" th:if="*{comment.replyCount > 0}" style="text-decoration: none; cursor: pointer"
         th:onclick="|viewReply(*{comment.id}, ${postId}, this)|" id="replyArea">
        <i style="vertical-align: text-bottom" class="fa fa-caret-down" aria-hidden="true"></i>&nbsp;
        <span th:text="*{comment.replyCount}"></span>
        <span th:text="#{reply}">리플</span>
      </a>

      <!-- 대댓글쓰기 및 다른사람 댓글들 -->
      <div class="ps-5">
        <!-- 대댓글쓰기 -->
        <div sec:authorize="isAuthenticated()" th:id="'replyForm' + *{comment.id}" class="mt-3" style="width: 80%; height: 50%" hidden>
          <form class="needs-validation col-sm-6" action="#" th:object="${commentForm}" style="width: 100%"
                th:action="@{'/reply/' + ${postId} + '/' + ${comment.id}}" method="post" enctype="multipart/form-data" novalidate>
            <!-- 코멘트-->

            <div class="input-group">
              <span class="input-group-text">reply</span>
              <textarea id="content" name="content" th:field="*{content}" style="height: 90px;" class="form-control" aria-label="With textarea" max="100"></textarea>
              <small class="form-text text-danger" th:if="${#fields.hasErrors('content')}" th:errors="*{content}">
                빈파일 | 정의되지 않은 확장자
              </small>
            </div>

            <div class="row justify-content-between">
              <div class="col-8">
                <div id="ACCEPTABLE_COMMENT_TYPES" th:text="*{ACCEPTABLE_COMMENT_TYPES}" hidden></div>
                <div class="form-group">
                  <label class="btn btn-default p-0 mt-1">
                    <input type="file" name="file" class="form-control" id="file" th:accept="*{ACCEPTABLE_COMMENT_TYPES}"
                           aria-describedby="fileHelp" th:field="*{file}" oninput="fileValidation()" />
                  </label>
                </div>

              </div>
              <div class="col-4 mt-2 text-end">
                <span class="btn btn-secondary btn-sm" type="button" th:onclick="|hideReplyForm(${comment.id})|" th:text="#{cancel}" style="display: inline">취소</span>
                <div class="form-group" style="display: inline">
                  <button class="btn btn-primary btn-sm" type="submit" th:text="#{upload}">업로드</button>
                </div>
              </div>
            </div>
          </form>
        </div>
        <!-- 대댓글 불러오기 -->
        <div th:id="'reply' + *{comment.id}"></div>
      </div>
    </div>
  </div>

  <!-- 댓글 더보기 -->
  <div class="mt-2">
    <a th:if="${itIsLastCommentPage == null}" class="mt-2"
       th:onclick="|viewComment(${post.id}, this)|" style="text-decoration: none; cursor: pointer">
      <i style="vertical-align: text-bottom" class="fa fa-caret-down" aria-hidden="true"></i>&nbsp;
      <span th:text="#{viewComment}">댓글 더보기</span>
    </a>
  </div>

  <div th:if="${itIsLastReplyPage} == null">
    <a th:if="${target == 'reply'}" style="text-decoration: none; cursor: pointer"
         th:onclick="|viewReply(${commentId}, ${postId}, this)|" class="mt-2">
      <i style="vertical-align: text-bottom" class="fa fa-caret-down" aria-hidden="true"></i>&nbsp;
      <span th:text="#{viewReply}">리플 더보기</span>
    </a>
  </div>
  <script th:src="@{/node_modules/jdenticon/dist/jdenticon.js}"></script>
</div>
<div th:fragment="voteAndShareRow" class="row justify-content-between">
  <div class="col-8 mt-2">
    <div sec:authorize="isAuthenticated()" th:id="'vote' + ${post.id}" style="display: inline">
      <div hidden>do not remove this div</div>
      <input type="button" id="upVoteBtn" class="btn btn-sm ms-1" th:classappend="${member.upVotedIds.contains(post.id)} ? 'btn-primary' : 'btn-outline-primary'"
             th:onclick="|vote('post', ${post.id}, true)|" th:value="'▲ ' + ${post.getVote().upVote}" />
      <input type="button" id="downVoteBtn" class="btn btn-sm ms-1" th:classappend="${member.downVotedIds.contains(post.id)} ? 'btn-primary' : 'btn-outline-primary'"
             th:onclick="|vote('post', ${post.id}, false)|" th:value="'▼ ' + ${post.getVote().downVote}" />
    </div>
    <div sec:authorize="!isAuthenticated()" th:id="'vote' + ${post.id}" style="display: inline">
      <div hidden>do not remove this div</div>
      <input type="button" id="upVoteBtn" class="btn btn-outline-primary btn-sm ms-1"
             th:onclick="|window.location.href = @{/} + 'login'|" th:value="'▲ ' + ${post.getVote().upVote}" />
      <input type="button" id="downVoteBtn" class="btn btn-outline-primary btn-sm ms-1"
             th:onclick="|window.location.href = @{/} + 'login'|" th:value="'▼ ' + ${post.getVote().downVote}" />
    </div>
    <div style="display: inline">
      <button type="button" class="btn btn-outline-primary btn-sm ms-1" th:onclick="|window.open(@{/} + 'post/' + ${post.id}, '_blank').focus()|">
        <i class="fa fa-commenting" aria-hidden="true"></i>&nbsp;<span th:text="${post.commentCount}"></span>
      </button>
    </div>
  </div>

  <div class="col-2 mt-2 me-1 text-end">
    <!-- TODO 공유기능 추가 -->
    <button type="button" class="btn btn-outline-primary btn-sm" th:onclick="|copyToClipboard(${post.id})|" data-bs-toggle="modal"
            th:data-bs-target="'#shareModal' + ${post.id}">
      <i class="fa fa-share-alt" aria-hidden="true"></i>
    </button>

    <!-- Modal -->
    <div class="modal fade" th:id="'shareModal' + ${post.id}" tabindex="-1" aria-labelledby="shareModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="shareModalLabel" th:text="#{clipboard.done}">클립보드에 복사되었습니다.</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <div th:id="shareModalContext + ${post.id}"> post url </div>
          </div>
        </div>
      </div>
    </div>

  </div>
  <script type="application/javascript">
    var copyToClipboard = function(postId) {
      var hostName = 'http://' + window.location.href.split('/')[2];
      var url =  hostName + contextPath + '/post/' + postId

      // inner text
      document.getElementById('shareModalContext' + postId).innerText = url;
      console.log(url)
      // copy to clipboard
      const el = document.createElement('textarea');
      el.value = url;
      document.body.appendChild(el);

      el.select();
      document.execCommand("copy"); //copy to clipboard

      document.body.removeChild(el);
    }
  </script>
</div>
<div th:fragment="date-time">
  <script th:src="@{/node_modules/moment/min/moment-with-locales.js}"></script>
  <script type="application/javascript">
    $(function () {

      moment.locale(navigator.language);

      $(".date-time").text(function(index, dateTime) {
        return moment(dateTime, "YYYY-MM-DD`T`hh:mm").format('LLL');
      });
      $(".date").text(function(index, dateTime) {
        return moment(dateTime).format('LL');
      });
      $(".weekday").text(function(index, dateTime) {
        return moment(dateTime, "YYYY-MM-DD`T`hh:mm").format('dddd');
      });
      $(".time").text(function(index, dateTime) {
        return moment(dateTime, "YYYY-MM-DD`T`hh:mm").format('LT');
      });
      $(".calendar").text(function(index, dateTime) {
        return moment(dateTime, "YYYY-MM-DD`T`hh:mm").calendar();
      });
      $(".fromNow").text(function(index, dateTime) {
        return moment(dateTime, "YYYY-MM-DD`T`hh:mm").fromNow();
      });
      $(".date-weekday-time").text(function(index, dateTime) {
        return moment(dateTime, "YYYY-MM-DD`T`hh:mm").format('LLLL');
      });
    })
  </script>
</div>

<div th:fragment="terms" style="display: inline">
  <!-- Button trigger modal -->
  <a href="#" th:text="#{signup.terms2}" data-bs-toggle="modal" data-bs-target="#termsModal">
    약관
  </a>

  <!-- Modal -->
  <div class="modal fade" id="termsModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel" th:text="#{signup.terms2}"></h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
            <p class="ls2 lh6 bs5 ts4"><em class="emphasis">&lt; valium &gt;('https://www.valium.dev'이하 'sweetmeme')</em>은(는) 「개인정보 보호법」 제30조에 따라 정보주체의 개인정보를 보호하고 이와 관련한 고충을 신속하고 원활하게 처리할 수 있도록 하기 위하여 다음과 같이 개인정보 처리방침을 수립·공개합니다.</p>
            <p class="ls2">○ 이 개인정보처리방침은 <em class="emphasis">2021</em>년 <em class="emphasis">10</em>월 <em class="emphasis">16</em>부터 적용됩니다.</p><br>
            <p class='lh6 bs4'><strong>제1조(개인정보의 처리 목적)<br>
                <br>
                <em class="emphasis">&lt; valium &gt;('https://www.valium.dev'이하 'sweetmeme')</em>은(는) 다음의 목적을 위하여 개인정보를 처리합니다. 처리하고 있는 개인정보는 다음의 목적 이외의 용도로는 이용되지 않으며 이용 목적이 변경되는 경우에는 「개인정보 보호법」 제18조에 따라 별도의 동의를 받는 등 필요한 조치를 이행할 예정입니다.</strong></p>
            <ul class="list_indent2 mgt10">
                <p class="ls2">1. 홈페이지 회원가입 및 관리</p>
                <p class="ls2">회원 가입의사 확인, 회원제 서비스 제공에 따른 본인 식별·인증, 회원자격 유지·관리, 서비스 부정이용 방지 목적으로 개인정보를 처리합니다.</p>
                <p class="ls2">2. 재화 또는 서비스 제공</p>
                <p class="ls2">서비스 제공을 목적으로 개인정보를 처리합니다.</p>
                <p class="ls2">3. 개인영상정보</p>
                <p class="ls2">범죄의 예방 및 수사 등을 목적으로 개인정보를 처리합니다.</p>
            </ul><br>
            <p class='lh6 bs4'><strong>제2조(개인정보의 처리 및 보유 기간)</strong><br>
                ① <em class="emphasis">&lt; valium &gt;</em>은(는) 법령에 따른 개인정보 보유·이용기간 또는 정보주체로부터 개인정보를 수집 시에 동의받은 개인정보 보유·이용기간 내에서 개인정보를 처리·보유합니다.<br>
                ② 각각의 개인정보 처리 및 보유 기간은 다음과 같습니다.</p>
            <ul class='list_indent2 mgt10'>
                <li class='tt'>1.&lt;�홈페이지 회원가입 및 관리&gt;</li>
                <li class='tt'>&lt;�홈페이지 회원가입 및 관리&gt;와 관련한 개인정보는 수집.이용에 관한 동의일로부터&lt;�지체없이 파기&gt;까지 위 이용목적을 위하여 보유.이용됩니다.</li>
                <li>보유근거 : 지체없이 파기</li>
                <li>관련법령 :</li>
                <li>예외사유 :</li>
            </ul><br>
            <p class='lh6 bs4'><strong>제3조(개인정보의 제3자 제공)</strong><br>
                ① <em class="emphasis">&lt; valium &gt;은(는) 개인정보를 제1조(개인정보의 처리 목적)에서 명시한 범위 내에서만 처리하며, 정보주체의 동의, 법률의 특별한 규정 등 「개인정보 보호법」 제17조 및 제18조에 해당하는 경우에만 개인정보를 제3자에게 제공합니다.</em></p>
            <p class="sub_p mgt10"><em class="emphasis">② <span class="colorLightBlue">&lt; valium &gt;</span>은(는) 다음과 같이 개인정보를 제3자에게 제공하고 있습니다.</em></p>
            <ul class="list_indent2 mgt10">
                <li class="tt"><em class="emphasis">1. &lt; &gt;</em></li>
                <li><em class="emphasis">개인정보를 제공받는 자 :</em></li>
                <li><em class="emphasis">제공받는 자의 개인정보 이용목적 :</em></li>
                <li><em class="emphasis">제공받는 자의 보유.이용기간:</em></li>
            </ul><em class="emphasis"><br></em>
            <p class='lh6 bs4'><em class="emphasis"><strong>제4조(개인정보처리 위탁)</strong><br>
                ① <em class="emphasis">&lt; valium &gt;</em>은(는) 원활한 개인정보 업무처리를 위하여 다음과 같이 개인정보 처리업무를 위탁하고 있습니다.</em></p>
            <ul class='list_indent2 mgt10'>
                <li class='tt'>1. &lt; &gt;</li>
                <li>위탁받는 자 (수탁자) :</li>
                <li>위탁하는 업무의 내용 :</li>
                <li>위탁기간 :</li>
            </ul>
            <p class='sub_p mgt10'>② <span class='colorLightBlue'>&lt; valium &gt;</span>은(는) 위탁계약 체결시 「개인정보 보호법」 제26조에 따라 위탁업무 수행목적 외 개인정보 처리금지, 기술적․관리적 보호조치, 재위탁 제한, 수탁자에 대한 관리․감독, 손해배상 등 책임에 관한 사항을 계약서 등 문서에 명시하고, 수탁자가 개인정보를 안전하게 처리하는지를 감독하고 있습니다.</p>
            <p class='sub_p mgt10'>③ 위탁업무의 내용이나 수탁자가 변경될 경우에는 지체없이 본 개인정보 처리방침을 통하여 공개하도록 하겠습니다.</p><br>
            <br>
            <p class="lh6 bs4"><strong>제5조(정보주체와 법정대리인의 권리·의무 및 그 행사방법)</strong></p>
            <p class="ls2"><br>
                <br>
                ① 정보주체는 valium에 대해 언제든지 개인정보 열람·정정·삭제·처리정지 요구 등의 권리를 행사할 수 있습니다.</p>
            <p class='sub_p'>② 제1항에 따른 권리 행사는valium에 대해 「개인정보 보호법」 시행령 제41조제1항에 따라 서면, 전자우편, 모사전송(FAX) 등을 통하여 하실 수 있으며 valium은(는) 이에 대해 지체 없이 조치하겠습니다.</p>
            <p class='sub_p'>③ 제1항에 따른 권리 행사는 정보주체의 법정대리인이나 위임을 받은 자 등 대리인을 통하여 하실 수 있습니다.이 경우 “개인정보 처리 방법에 관한 고시(제2020-7호)” 별지 제11호 서식에 따른 위임장을 제출하셔야 합니다.</p>
            <p class='sub_p'>④ 개인정보 열람 및 처리정지 요구는 「개인정보 보호법」 제35조 제4항, 제37조 제2항에 의하여 정보주체의 권리가 제한 될 수 있습니다.</p>
            <p class='sub_p'>⑤ 개인정보의 정정 및 삭제 요구는 다른 법령에서 그 개인정보가 수집 대상으로 명시되어 있는 경우에는 그 삭제를 요구할 수 없습니다.</p>
            <p class='sub_p'>⑥ valium은(는) 정보주체 권리에 따른 열람의 요구, 정정·삭제의 요구, 처리정지의 요구 시 열람 등 요구를 한 자가 본인이거나 정당한 대리인인지를 확인합니다.</p><br>
            <p class='lh6 bs4'><strong>제6조(처리하는 개인정보의 항목 작성)</strong><br>
                ① <em class="emphasis">&lt; valium &gt;</em>은(는) 다음의 개인정보 항목을 처리하고 있습니다.</p>
            <ul class='list_indent2 mgt10'>
                <li class='tt'>1&lt; 홈페이지 회원가입 및 관리 &gt;</li>
                <li>필수항목 : 이메일, 비밀번호, 쿠키</li>
                <li>선택항목 :</li>
            </ul><br>
            <p class='lh6 bs4'><strong>제7조(개인정보의 파기)</strong></p>
            <p class='ls2'><em class="emphasis"><br>
                ① &lt; valium &gt; 은(는) 개인정보 보유기간의 경과, 처리목적 달성 등 개인정보가 불필요하게 되었을 때에는 지체없이 해당 개인정보를 파기합니다.<br>
                ② 정보주체로부터 동의받은 개인정보 보유기간이 경과하거나 처리목적이 달성되었음에도 불구하고 다른 법령에 따라 개인정보를 계속 보존하여야 하는 경우에는, 해당 개인정보를 별도의 데이터베이스(DB)로 옮기거나 보관장소를 달리하여 보존합니다.<br>
                1. 법령 근거 :<br>
                2. 보존하는 개인정보 항목 : 계좌정보, 거래날짜<br>
                ③ 개인정보 파기의 절차 및 방법은 다음과 같습니다.<br>
                1. 파기절차<br>
                &lt; valium &gt; 은(는) 파기 사유가 발생한 개인정보를 선정하고, &lt; valium &gt; 의 개인정보 보호책임자의 승인을 받아 개인정보를 파기합니다.<br></em></p>
            <p class='sub_p mgt10'><em class="emphasis">2. 파기방법</em></p>
            <p class='sub_p'><em class="emphasis">전자적 파일 형태의 정보는 기록을 재생할 수 없는 기술적 방법을 사용합니다</em></p><em class="emphasis"><br></em>
            <p class='lh6 bs4'><em class="emphasis"><strong>제8조(개인정보의 안전성 확보 조치)<em class="emphasis"><br>
                &lt; valium &gt;</em>은(는) 개인정보의 안전성 확보를 위해 다음과 같은 조치를 취하고 있습니다.</strong></em></p>
            <p class='sub_p mgt10'>1. 개인정보의 암호화<br>
                이용자의 개인정보는 비밀번호는 암호화 되어 저장 및 관리되고 있어, 본인만이 알 수 있으며 중요한 데이터는 파일 및 전송 데이터를 암호화 하거나 파일 잠금 기능을 사용하는 등의 별도 보안기능을 사용하고 있습니다.<br>
                2. 접속기록의 보관 및 위변조 방지<br>
                개인정보처리시스템에 접속한 기록을 최소 1년 이상 보관, 관리하고 있으며,다만, 5만명 이상의 정보주체에 관하여 개인정보를 추가하거나, 고유식별정보 또는 민감정보를 처리하는 경우에는 2년이상 보관, 관리하고 있습니다.<br>
                또한, 접속기록이 위변조 및 도난, 분실되지 않도록 보안기능을 사용하고 있습니다.<br></p><br>
            <p class="lh6 bs4"><strong>제9조(개인정보 자동 수집 장치의 설치•운영 및 거부에 관한 사항)</strong></p>
            <p class="ls2"><br>
                <br>
                ① valium 은(는) 이용자에게 개별적인 맞춤서비스를 제공하기 위해 이용정보를 저장하고 수시로 불러오는 ‘쿠키(cookie)’를 사용합니다.<br>
                ② 쿠키는 웹사이트를 운영하는데 이용되는 서버(http)가 이용자의 컴퓨터 브라우저에게 보내는 소량의 정보이며 이용자들의 PC 컴퓨터내의 하드디스크에 저장되기도 합니다.<br>
                가. 쿠키의 사용 목적 : 이용자가 방문한 각 서비스와 웹 사이트들에 대한 방문 및 이용형태, 인기 검색어, 보안접속 여부, 등을 파악하여 이용자에게 최적화된 정보 제공을 위해 사용됩니다.<br>
                나. 쿠키의 설치•운영 및 거부 : 웹브라우저 상단의 도구&gt;인터넷 옵션&gt;개인정보 메뉴의 옵션 설정을 통해 쿠키 저장을 거부 할 수 있습니다.<br>
                다. 쿠키 저장을 거부할 경우 맞춤형 서비스 이용에 어려움이 발생할 수 있습니다.</p>
            <p class='sub_p mgt30'><strong>제10조 (개인정보 보호책임자)</strong></p>
            <p class='sub_p mgt10'>① <span class='colorLightBlue'>valium</span> 은(는) 개인정보 처리에 관한 업무를 총괄해서 책임지고, 개인정보 처리와 관련한 정보주체의 불만처리 및 피해구제 등을 위하여 아래와 같이 개인정보 보호책임자를 지정하고 있습니다.</p>
            <ul class='list_indent2 mgt10'>
                <li class='tt'>▶ 개인정보 보호책임자</li>
                <li>성명 :valium</li>
                <li>직책 :none</li>
                <li>직급 :none</li>
                <li>연락처 :none, emailconfirmation1677@gmail.com, none</li>
            </ul>
            <p class='sub_p'>※ 개인정보 보호 담당부서로 연결됩니다.</p>
            <ul class='list_indent2 mgt10'>
                <li class='tt'>▶ 개인정보 보호 담당부서</li>
                <li>부서명 :</li>
                <li>담당자 :</li>
                <li>연락처 :, ,</li>
            </ul>
            <p class='sub_p'>② 정보주체께서는 valium 의 서비스(또는 사업)을 이용하시면서 발생한 모든 개인정보 보호 관련 문의, 불만처리, 피해구제 등에 관한 사항을 개인정보 보호책임자 및 담당부서로 문의하실 수 있습니다. valium 은(는) 정보주체의 문의에 대해 지체 없이 답변 및 처리해드릴 것입니다.</p>
            <p class='sub_p mgt30'><strong>제11조(개인정보 열람청구)<br>
                정보주체는 ｢개인정보 보호법｣ 제35조에 따른 개인정보의 열람 청구를 아래의 부서에 할 수 있습니다.<br>
                &lt; valium &gt;</strong>은(는) 정보주체의 개인정보 열람청구가 신속하게 처리되도록 노력하겠습니다.</p>
            <ul class='list_indent2 mgt10'>
                <li class='tt'>▶ 개인정보 열람청구 접수·처리 부서</li>
                <li>부서명 :</li>
                <li>담당자 :</li>
                <li>연락처 : , ,</li>
            </ul><br>
            <p class='lh6 bs4'><strong>제12조(권익침해 구제방법)</strong></p><br>
            <br>
            정보주체는 개인정보침해로 인한 구제를 받기 위하여 개인정보분쟁조정위원회, 한국인터넷진흥원 개인정보침해신고센터 등에 분쟁해결이나 상담 등을 신청할 수 있습니다. 이 밖에 기타 개인정보침해의 신고, 상담에 대하여는 아래의 기관에 문의하시기 바랍니다.<br>
            <br>
            1. 개인정보분쟁조정위원회 : (국번없이) 1833-6972 (www.kopico.go.kr)<br>
            2. 개인정보침해신고센터 : (국번없이) 118 (privacy.kisa.or.kr)<br>
            3. 대검찰청 : (국번없이) 1301 (www.spo.go.kr)<br>
            4. 경찰청 : (국번없이) 182 (ecrm.cyber.go.kr)<br>
            <br>
            「개인정보보호법」제35조(개인정보의 열람), 제36조(개인정보의 정정·삭제), 제37조(개인정보의 처리정지 등)의 규정에 의한 요구에 대 하여 공공기관의 장이 행한 처분 또는 부작위로 인하여 권리 또는 이익의 침해를 받은 자는 행정심판법이 정하는 바에 따라 행정심판을 청구할 수 있습니다.<br>
            <br>
            ※ 행정심판에 대해 자세한 사항은 중앙행정심판위원회(www.simpan.go.kr) 홈페이지를 참고하시기 바랍니다.<br>
            <p class='lh6 bs4'></p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>
</div>
<!----------------------------------------------------------------------------------------->

</html>
